\chapter{Diseño de la integración}

Este es un capítulo que tiene como objetivo explicar como se integran entre si las herramientas del proyecto, Ksensor con las modificaciones expuestas y los módulos de trazas y estadísticas. Para guiar la explicación, se puede referir a  \reference{fig:integracion-modular}{Figura de integración de los módulos}

\begin{figure}[h]
\centering
\includegraphics[width=\linewidth]{Integracion}
\caption{Integración de los módulos entre si}
\label{fig:integracion-modular}
\end{figure}

En la figura, se han referenciado las 3 partes que componen el kernel, y donde se introduce o modifica código. Apoyando la explicación en la figura, se explicará la integración entre ksensor y los módulos.

\section{Ksensor y el módulo de estadísticas}

En la figura se ha representado el módulo de estadísticas como un módulo compuesto de dos partes, una propiamente dicha, el módulo, la parte que se puede insertar y extraer, y la parte que está estáticamente integrada en el kernel.

Dependiendo de las opciones de compilación, en caso de habilitar Ksensor y el módulo de estadísticas simultáneamente, se activan directamente las estadísticas dentro de Ksensor, a parte de las estadísticas internas del mismo. En caso de no habilitar Ksensor, el módulo de estadísticas se compilaría con solo una parte de las mismas.

\section{Ksensor y el módulo de trazas}

Este módulo ha sido diseñado para tener un funcionamiento al margen de Ksensor, y de hecho en la implementación actual, tracea softirqs, por lo que no se perdería funcionalidad en este. En caso de implementar trazas dentro de Ksensor, se dejarían de compilar, pero este módulo quedaría disponible para el resto del sistema.

\section{Estadísticas y trazas}

Entre estos dos módulos, al requerir en algunas partes de código efectuar las mismas medidas, solo interactúan a nivel de implementación. En el diseño de bajo nivel se darán explicará de una forma más concreta el tipo de interacción que tienen.